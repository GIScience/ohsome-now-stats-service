-- generated by org.heigit.ohsome.now.statsservice.SqlGenerator at 2024-01-29T11:31:07.039642Z


-- for metadata endpoint
ALTER TABLE prod.stats_2 ADD PROJECTION timestamp_projection_2 (
    SELECT
        changeset_timestamp
    ORDER BY
        changeset_timestamp
);

ALTER TABLE prod.stats_2 MATERIALIZE PROJECTION timestamp_projection_2;


-- for hot-tm-user endpoint 
ALTER TABLE prod.stats_2 ADD PROJECTION user_id_projection_2 (
    SELECT
        user_id,
        hashtag,
        building_edit,
        road_length_delta,
        map_feature_edit,
        changeset_id
    ORDER BY
        user_id,
        hashtag
);

ALTER TABLE prod.stats_2 MATERIALIZE PROJECTION user_id_projection_2;


-- for hashtags endpoint
ALTER TABLE prod.stats_2 ADD PROJECTION hashtag_aggregation_projection_2
(
    SELECT 
        hashtag,
        count(*)
    GROUP BY hashtag
);

ALTER TABLE prod.stats_2 MATERIALIZE PROJECTION hashtag_aggregation_projection_2;